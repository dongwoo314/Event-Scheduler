# 🔔 알림 시스템 구조 분석 및 정의

## 🤔 현재 알림 구조 질문
**"사전 알림 이후 추가로 해당 시간에 알림이 가는 구조인가?"**

---

## 📋 현재 설계된 알림 구조

### 현재 구조 (설계 의도)
```
이벤트 시간: 14:00 (오후 2시)
사전 알림 설정: [1시간 전, 30분 전]

실제 발송되는 알림:
├── 13:00 - "1시간 후 팀 미팅이 있습니다" (사전 알림)
├── 13:30 - "30분 후 팀 미팅이 있습니다" (사전 알림)
└── 14:00 - "팀 미팅이 시작됩니다" (정시 알림) ← 이 부분이 명확하지 않았음
```

## 🎯 알림 타이밍 구조 재정의

### 1. 완전한 알림 시스템 (권장)
```
📅 이벤트: "팀 미팅" (2024-12-25 14:00)
⚙️ 설정: 사전 알림 [1h, 30m] + 정시 알림 활성화

발송 스케줄:
┌─────────────────────────────────────┐
│ 13:00 ⏰ 사전 알림                   │
│ "1시간 후 팀 미팅이 시작됩니다"        │
│                                     │
│ 13:30 ⏰ 사전 알림                   │
│ "30분 후 팀 미팅이 시작됩니다"        │
│                                     │
│ 14:00 🔔 정시 알림 (메인)            │
│ "팀 미팅이 지금 시작됩니다"           │
└─────────────────────────────────────┘
```

### 2. 사전 알림만 (대안)
```
📅 이벤트: "팀 미팅" (2024-12-25 14:00)
⚙️ 설정: 사전 알림 [1h, 30m] + 정시 알림 비활성화

발송 스케줄:
┌─────────────────────────────────────┐
│ 13:00 ⏰ 사전 알림                   │
│ "1시간 후 팀 미팅이 시작됩니다"        │
│                                     │
│ 13:30 ⏰ 사전 알림 (마지막)           │
│ "30분 후 팀 미팅이 시작됩니다"        │
│                                     │
│ 14:00 (알림 없음)                   │
└─────────────────────────────────────┘
```

---

## 🎯 권장 알림 구조

### 기본 원칙
```
모든 이벤트는 다음과 같은 알림을 가질 수 있습니다:

1. 사전 알림 (Pre-notifications)
   - 사용자가 설정한 시간 전에 발송
   - 준비 시간을 확보하기 위한 목적
   - 예: "30분 후 회의가 있습니다"

2. 정시 알림 (Event-time notification)
   - 정확한 이벤트 시작 시간에 발송
   - 이벤트 시작을 알리는 목적
   - 예: "회의가 지금 시작됩니다"

3. 지연 알림 (Late notification) - 선택사항
   - 이벤트 시간이 지났는데 응답이 없을 때
   - 예: "회의에 참석하지 않으셨습니다"
```

### 사용자 선택 옵션
```
알림 설정 UI:
┌─────────────────────────────────────┐
│ ✅ 사전 알림: [1시간 전] [30분 전]    │
│ ✅ 정시 알림: 이벤트 시작 시          │
│ ☐ 지연 알림: 5분 후 미참석 시         │
└─────────────────────────────────────┘
```

---

## 🔧 구체적인 구현 구조

### 알림 스케줄러 로직
```javascript
// 이벤트 생성 시 알림 스케줄 생성
function createNotificationSchedule(event) {
  const notifications = [];
  
  // 1. 사전 알림들
  event.preReminders.forEach(reminderTime => {
    notifications.push({
      triggerTime: event.startTime - reminderTime,
      type: 'pre-reminder',
      message: `${formatTime(reminderTime)} 후 ${event.title}이(가) 시작됩니다`,
      priority: 'medium'
    });
  });
  
  // 2. 정시 알림 (옵션)
  if (event.enableEventTimeNotification) {
    notifications.push({
      triggerTime: event.startTime,
      type: 'event-start',
      message: `${event.title}이(가) 지금 시작됩니다`,
      priority: 'high'
    });
  }
  
  // 3. 지연 알림 (옵션)
  if (event.enableLateNotification) {
    notifications.push({
      triggerTime: event.startTime + (5 * 60 * 1000), // 5분 후
      type: 'late-notification',
      message: `${event.title}에 참석하지 않으셨습니다`,
      priority: 'low',
      condition: 'if_not_acknowledged'
    });
  }
  
  return notifications;
}
```

### 알림 메시지 차별화
```
사전 알림 메시지:
"🕐 30분 후 팀 미팅이 시작됩니다"
"📍 장소: 회의실 A"
"👥 참석자: 5명"

정시 알림 메시지:
"🔔 팀 미팅이 지금 시작됩니다!"
"🚀 회의실 A로 이동해주세요"
"📱 Zoom 링크: [클릭하여 참여]"
```

---

## 📱 UI 개선 사항

### 알림 설정 화면 업데이트
```
현재 UI에 추가할 요소:

┌─────────────────────────────────────┐
│ 📅 날짜: 2024-12-25                │
│ ⏰ 시간: 14:00                     │
│ 📝 제목: 팀 미팅                    │
│                                     │
│ 🔔 알림 설정:                       │
│ ┌─────────────────────────────────┐ │
│ │ ✅ 사전 알림                     │ │
│ │   [30분 전] [1시간 전] [1일 전]   │ │
│ │                                 │ │
│ │ ✅ 정시 알림                     │ │
│ │   이벤트 시작 시간에 알림          │ │
│ │                                 │ │
│ │ ☐ 지연 알림                     │ │
│ │   5분 후 미참석 시 알림           │ │
│ └─────────────────────────────────┘ │
└─────────────────────────────────────┘
```

### 알림 목록에서 구분 표시
```
알림 목록:
┌─────────────────────────────────────┐
│ 🕐 13:30 팀 미팅 30분 전 (사전)      │
│ 🔔 14:00 팀 미팅 시작 (정시)         │
│ 🕐 15:30 점심약속 30분 전 (사전)     │
└─────────────────────────────────────┘
```

---

## 🤔 사용자 선택 권한

### 유연한 설정 옵션 제공
```
사용자 시나리오별 설정:

시나리오 1: "미리 준비하고 싶어요"
├── 사전 알림: 활성화 (1시간 전, 30분 전)
├── 정시 알림: 활성화
└── 지연 알림: 비활성화

시나리오 2: "너무 많은 알림은 싫어요"
├── 사전 알림: 30분 전만
├── 정시 알림: 비활성화
└── 지연 알림: 비활성화

시나리오 3: "절대 놓치면 안 되는 중요한 일정"
├── 사전 알림: 1일 전, 1시간 전, 10분 전
├── 정시 알림: 활성화
└── 지연 알림: 활성화
```

---

## 🎯 결론 및 권장사항

### 권장하는 기본 구조:
1. **사전 알림 + 정시 알림**을 기본으로 제공
2. **사용자가 선택**할 수 있도록 옵션 제공
3. **알림 타입별 차별화**된 메시지와 우선순위

### 구현 우선순위:
1. **Phase 1**: 사전 알림 + 정시 알림
2. **Phase 2**: 지연 알림, 스마트 알림
3. **Phase 3**: AI 기반 최적 알림 시점 추천

이런 구조로 알림 시스템을 설계하는 것이 어떠신가요? 정시 알림을 포함할지, 아니면 사전 알림만으로 할지에 대한 의견이 있으시나요?
